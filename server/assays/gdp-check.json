{
  "id": "gdp-check-v1",
  "name": "Country GDP Verification",
  "version": "1.0.0",
  "domain": "economics",
  "description": "Verifies country GDP claims against World Bank and Wikidata",
  "inputs": {
    "entity": true,
    "year": true,
    "claimed_value": true
  },
  "fetch_plan": {
    "sources": [
      {
        "name": "worldbank",
        "endpoint": "https://api.worldbank.org/v2/country/{entity}/indicator/NY.GDP.MKTP.CD",
        "method": "GET",
        "headers": {
          "Accept": "application/json"
        },
        "cache_ttl": 86400,
        "timeout": 10000
      },
      {
        "name": "wikidata",
        "endpoint": "https://query.wikidata.org/sparql",
        "method": "SPARQL",
        "query": "SELECT ?gdp ?year WHERE { ?country wdt:P31 wd:Q6256 ; rdfs:label \"{entity}\"@en ; p:P2131 ?statement . ?statement ps:P2131 ?gdp ; pq:P585 ?date . BIND(YEAR(?date) AS ?year) FILTER(?year = {year}) }",
        "cache_ttl": 86400,
        "timeout": 15000
      }
    ],
    "parallel": true,
    "fail_fast": false
  },
  "parsers": {
    "worldbank": {
      "type": "jsonpath",
      "expression": "$[1][?(@.date==\"{year}\")].value",
      "transform": "parseFloat"
    },
    "wikidata": {
      "type": "sparql",
      "expression": "$.results.bindings[0].gdp.value",
      "transform": "parseFloat"
    }
  },
  "expected_signal": {
    "unit": "USD",
    "tolerance": "10%",
    "comparison_rule": "within_tolerance",
    "consensus_rule": "majority_within_tolerance",
    "min_sources": 2
  },
  "validation_hooks": [
    {
      "type": "unit_check",
      "params": {
        "expected_unit": "USD"
      }
    },
    {
      "type": "range_check",
      "params": {
        "min_value": 1000000,
        "max_value": 100000000000000
      }
    }
  ],
  "cost_hints": {
    "estimated_time_ms": 3000,
    "estimated_tokens": 0,
    "estimated_cost_usd": 0
  },
  "safe_mode": true,
  "claim_patterns": [
    "(?i){entity}.*?GDP.*?([\\d,]+(?:\\.\\d+)?\\s*(?:trillion|billion|million|t|b|m)?)",
    "(?i)GDP.*?{entity}.*?([\\d,]+(?:\\.\\d+)?\\s*(?:trillion|billion|million|t|b|m)?)",
    "(?i){entity}.*?economy.*?([\\d,]+(?:\\.\\d+)?\\s*(?:trillion|billion|million|t|b|m)?)"
  ]
}
